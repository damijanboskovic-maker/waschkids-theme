{% comment %}
  Product Showcase Section with Swiper.js
  Enhanced with gradient background, no card background, and solid image background
  Optimized for smooth mobile performance
{% endcomment %}

{% liquid
  assign collection = collections[section.settings.collection]
  if collection == empty
    assign collection = collections.all
  endif

  assign products_limit = section.settings.products_to_show | default: 8
%}

<div
  class="product-showcase-section"
  style="
    padding-top:{{ section.settings.padding-block-start }}px;
    padding-bottom:{{ section.settings.padding-block-end}}px;
    margin-top: {{ section.settings.margin_top }}px;
    --section-bg-start: {{ section.settings.section_bg_start | default: '#FF6B6B' }};
    --section-bg-end: {{ section.settings.section_bg_end | default: '#4ECDC4' }};
    --primary-text-color: {{ section.settings.primary_text_color | default: '#2C1810' }};
    --secondary-text-color: {{ section.settings.secondary_text_color | default: '#666666' }};
    --card-content-bg: {{ section.settings.card_content_bg | default: 'rgba(255, 255, 255, 0.95)' }};
    --image-bg-color: {{ section.settings.image_bg_color | default: '#FFE066' }};
    --title-bg-color: {{ section.settings.titel_bg_color }};
    --cta-bg-color: {{ section.settings.cta_bg_color | default: '#2C1810' }};
    --cta-text-color: {{ section.settings.cta_text_color | default: '#FFFFFF' }};
    --cta-hover-bg: {{ section.settings.cta_hover_bg | default: '#1a0f0a' }};
    --cta-sold-out-bg: {{ section.settings.cta_sold_out_bg | default: '#dc3545' }};
  "
  {{ section.shopify_attributes }}
>
  <div class="section section--{{ section.settings.section_width }}">
    {% if section.settings.heading != blank or section.settings.shop_all_text != blank %}
      <div class="product-showcase__header">
        {% if section.settings.heading != blank %}
          <h2 class="product-showcase__title {{ section.settings.heading_size }}">
            {{ section.settings.heading }}
          </h2>
        {% endif %}

        {% if section.settings.shop_all_text != blank and section.settings.shop_all_link != blank %}
          <a href="{{ section.settings.shop_all_link }}" class="product-showcase__shop-all">
            {{ section.settings.shop_all_text }}
          </a>
        {% endif %}
      </div>
    {% endif %}

    <div class="product-showcase__slider-container" style="position: relative;">
      {% if section.settings.show_navigation %}
        <div class="product-showcase__navigation">
          <button type="button" class="product-showcase__nav-button product-showcase__nav-prev" aria-label="Vorheriges Produkt">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
              <path d="M0 0h24v24H0V0z" fill="none"/>
              <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12l4.58-4.59z"/>
            </svg>
          </button>

          <button type="button" class="product-showcase__nav-button product-showcase__nav-next" aria-label="Nächstes Produkt">
            <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px">
              <path d="M0 0h24v24H0V0z" fill="none"/>
              <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6-6-6z"/>
            </svg>
          </button>
        </div>
      {% endif %}
      
      <div class="swiper product-showcase-swiper-{{ section.id }}">
        <div class="swiper-wrapper">
          {% for product in collection.products limit: products_limit %}
            <div class="swiper-slide">
              <div class="product-showcase__card">
                <div class="product-showcase__image-container">
                  {% if product.featured_image %}
                      <img src="{{ product.featured_image | img_url: '800x' }}" width="auto" height="auto" loading="lazy" decoding="async" alt="{{ product.featured_image.alt | default: product.title }}" class="product-showcase__image" />
                  {% else %}
                    <div class="product-showcase__placeholder">
                      {{ 'image' | placeholder_svg_tag }}
                    </div>
                  {% endif %}
                </div>

                <h3 class="product-showcase__product-title">
                  {{ product.title | upcase }}
                </h3>

                <div class="product-showcase__content">
                  {% if section.settings.show_product_description and product.description != blank %}
                    <p class="product-showcase__description">
                      {{ product.description | strip_html | truncate: 70 }}
                    </p>
                  {% endif %}
                     {% if product.metafields.custom.fakten != blank %}
                         <div class="product-showcase__fakten">
                        {% for fakt in product.metafields.custom.fakten.value %}
                      <div class="product-showcase__fakt--wrapper">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48">
                                <path fill="#43A047" d="M40.6 12.1L17 35.7 7.4 26.1 4.6 29 17 41.3 43.4 14.9z"></path>
                              </svg>
                        <span class="product-showcase__fakt">{{ fakt }}</span>
                      </div>
                      {% endfor %}
                         </div>
                      {% endif %}

                  {% if section.settings.show_price %}
                    <div class="product-showcase__price">
                      {% if product.compare_at_price > product.price %}
                        <span class="product-showcase__price-amount">{{ product.price | money }}</span>
                      {% else %}
                        <span class="product-showcase__price-amount">{{ product.price | money }}</span>
                      {% endif %}
                      
                      {% assign selected_variant = product.selected_or_first_available_variant %}
                      {% if selected_variant.available %}
                        <button type="button" 
                                class="product-showcase__cta product-showcase__cta--available" 
                                data-product-id="{{ product.id }}" 
                                data-variant-id="{{ selected_variant.id }}" 
                                data-quantity="1"
                                data-product-title="{{ product.title | escape }}"
                                aria-label="Add {{ product.title }} to cart">
                          <span class="product-showcase__cta-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <path d="M6 2L3 6v14c0 1.1.9 2 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/>
                              <line x1="3" y1="6" x2="21" y2="6"/>
                              <path d="M16 10a4 4 0 0 1-8 0"/>
                            </svg>
                          </span>
                          <span class="product-showcase__cta-text">In den Warenkorb</span>
                        </button>
                      {% else %}
                        <button type="button" 
                                class="product-showcase__cta product-showcase__cta--sold-out" 
                                disabled
                                aria-label="{{ product.title }} is sold out">
                          <span class="product-showcase__cta-icon">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                              <circle cx="12" cy="12" r="10"/>
                              <line x1="4.93" y1="4.93" x2="19.07" y2="19.07"/>
                            </svg>
                          </span>
                          <span class="product-showcase__cta-text">Ausverkauft</span>
                        </button>
                      {% endif %}
                    </div>
                  {% endif %}
                </div>
                {% if section.settings.show_product_link and section.settings.show_price == false %}
                  <a href="{{ product.url }}" class="product-showcase__link">
                    <span class="visually-hidden">{{ product.title }}</span>
                  </a>
                {% endif %}
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>
</div>

<script>


function setupUpcartCloseListener() {
  const host = document.querySelector('#upCart');
  if (!host || !host.shadowRoot) {
    setTimeout(setupUpcartCloseListener, 200);
    return;
  }

  const attachListener = () => {
    const button = host.shadowRoot.querySelector('.upcart-header-close-button');
    if (button && !button.hasAttribute('data-listener-attached')) {
      button.setAttribute('data-listener-attached', 'true'); // prevent duplicates
      button.addEventListener('click', () => {
        console.log("vlick");
        document.body.classList.remove('overflow-hidden');
      }, { passive: true });
    }
  };

  // Initial attempt
  attachListener();

  // Watch for re-renders inside shadow root
  const observer = new MutationObserver(() => {
    attachListener();
  });

  observer.observe(host.shadowRoot, { childList: true, subtree: true });
}

setupUpcartCloseListener();




  
  document.addEventListener('DOMContentLoaded', function() {
    // Detect if device is mobile
    const isMobile = window.innerWidth < 1024;
    
    // Initialize Swiper with mobile optimizations
    const swiperConfig = {
      slidesPerView: 'auto',
      spaceBetween: {{ section.settings.gap_mobile  }},
      loop: isMobile ? false : {{ section.settings.loop  }}, // Loop auf Mobile deaktiviert
      // Autoplay nur auf Desktop (ab 1024px), auf Mobile deaktiviert
      autoplay: (!isMobile && {{ section.settings.autoplay }}) ? {
        delay: {{ section.settings.autoplay_delay  }},
        disableOnInteraction: false,
        pauseOnMouseEnter: true
      } : false,
      speed: isMobile ? 250 : {{ section.settings.transition_speed }},

      // Mobile Performance Optimizations - Maximum Performance
      freeMode: false, // Deaktiviert für konsistentere Performance
      touchRatio: 1,
      touchAngle: 45,
      grabCursor: !isMobile,
      preventInteractionOnTransition: false, // Erlaubt Touch während Transition
      threshold: 3, // Niedriger Threshold für responsive Swipen
      touchStartPreventDefault: false,
      passiveListeners: true,
      resistance: true,
      resistanceRatio: 0.85,
      
      // Optimized touch handling für maximale Flüssigkeit
      touchEventsTarget: 'wrapper',
      simulateTouch: true,
      shortSwipes: true,
      longSwipes: true,
      longSwipesRatio: 0.5,
      longSwipesMs: 300,
      followFinger: true,
      allowTouchMove: true,
      touchReleaseOnEdges: false,
      
      // CSS Mode für native scrolling performance (nur Mobile)
      cssMode: isMobile ? true : false,
      
      // Reduziert Slides außerhalb des Viewports
      watchSlidesProgress: true,
      watchSlidesVisibility: true,

      {% if section.settings.show_navigation %}
      navigation: {
        nextEl: '.product-showcase__nav-next',
        prevEl: '.product-showcase__nav-prev',
      },
      {% endif %}

      breakpoints: {
        640: {
          spaceBetween: {{ section.settings.gap_tablet  }},
          cssMode: true,
        },
        768: {
          spaceBetween: {{ section.settings.gap_tablet}},
          cssMode: true,
        },
        1024: {
          spaceBetween: {{ section.settings.gap_desktop  }},
          loop: {{ section.settings.loop  }}, // Loop auf Desktop aktivieren
          cssMode: false, // CSS Mode auf Desktop deaktivieren
          freeMode: false,
          speed: {{ section.settings.transition_speed }},
          // Autoplay ab Desktop wieder aktivieren wenn eingestellt
          autoplay: {{ section.settings.autoplay }} ? {
            delay: {{ section.settings.autoplay_delay  }},
            disableOnInteraction: false,
            pauseOnMouseEnter: true
          } : false,
        },
        1280: {
          spaceBetween: {{ section.settings.gap_large }},
        }
      }
    };

    new Swiper('.product-showcase-swiper-{{ section.id }}', swiperConfig);

    // Add to Cart functionality
    class ProductShowcaseCart {
      constructor() {
        this.cartDrawer = document.querySelector('cart-drawer');
        this.initializeButtons();
      }

      initializeButtons() {
        const ctaButtons = document.querySelectorAll('.product-showcase__cta--available');
        
        ctaButtons.forEach(button => {
          button.addEventListener('click', (e) => this.handleAddToCart(e), { passive: false });
          button.addEventListener('keydown', (e) => {
            if (e.code === 'Enter' || e.code === 'Space') {
              e.preventDefault();
              this.handleAddToCart(e);
            }
          }, { passive: false });
        });
      }

      async handleAddToCart(event) {
        // Prevent event bubbling to avoid triggering the card link
        event.preventDefault();
        event.stopPropagation();
        event.stopImmediatePropagation();

        const button = event.currentTarget;
        const variantId = button.dataset.variantId;
        const quantity = parseInt(button.dataset.quantity) || 1;
        const productTitle = button.dataset.productTitle;

        console.log('Add to cart clicked:', { variantId, quantity, productTitle });

        // Simple loading state
        const originalText = button.querySelector('.product-showcase__cta-text').textContent;
        const textElement = button.querySelector('.product-showcase__cta-text');
        
        button.disabled = true;
        textElement.textContent = 'Wird hinzugefügt...';

        try {
          const response = await this.addToCartAPI(variantId, quantity);
          
          if (response.ok) {
            // Success! Update cart drawer and open it
            if (this.cartDrawer) {
              await this.cartDrawer.refresh();
              this.cartDrawer.open(button);
            }
            
            // Brief success feedback
            textElement.textContent = 'Hinzugefügt!';
            
            // Reset after 1.5 seconds
            setTimeout(() => {
              textElement.textContent = originalText;
              button.disabled = false;
            }, 1500);

            // Dispatch custom event for tracking/analytics
            window.dispatchEvent(new CustomEvent('product:added-to-cart', {
              detail: { variantId, quantity, productTitle }
            }));

          } else {
            const errorData = await response.json();
            throw new Error(errorData.message || 'Fehler beim Hinzufügen zum Warenkorb');
          }
        } catch (error) {
          console.error('Add to cart error:', error);
          textElement.textContent = 'Erneut versuchen';
          
          // Reset button after error
          setTimeout(() => {
            textElement.textContent = originalText;
            button.disabled = false;
          }, 3000);

          // Show error notification
          this.showErrorNotification(error.message);
        }
      }

      async addToCartAPI(variantId, quantity) {
        return fetch('/cart/add.js', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: JSON.stringify({
            id: variantId,
            quantity: quantity
          })
        });
      }

      showErrorNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'product-showcase__error-notification';
        notification.textContent = message || 'Fehler beim Hinzufügen zum Warenkorb';
        
        document.body.appendChild(notification);
        
        setTimeout(() => {
          notification.remove();
        }, 5000);
      }
    }

    // Initialize add to cart functionality
    new ProductShowcaseCart();
  });
</script>

<style>
    .product-showcase-section {
      position: relative;
      background: linear-gradient(135deg, var(--section-bg-start) 0%, var(--section-bg-end) 100%);
      overflow: hidden;
    }
    
    /* Performance-Optimierung: Gradient wird auf GPU gerendert */
    .product-showcase-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: inherit;
      z-index: -1;
      will-change: transform;
      transform: translateZ(0);
      -webkit-transform: translateZ(0);
    }

    .product-showcase__header {
      margin-bottom: 3rem;
    }

    .product-showcase__title {
      font-weight: 700;
      color: var(--primary-text-color);
      margin: 0 0 1rem 0;
      line-height: 1.1;
      letter-spacing: -0.02em;
    }

    .product-showcase__title.h1 { font-size: clamp(2.5rem, 5vw, 4.5rem); }
    .product-showcase__title.h2 { font-size: clamp(2rem, 4vw, 3.5rem); }
    .product-showcase__title.h3 { font-size: clamp(1.75rem, 3.5vw, 2.5rem); }

    .product-showcase__shop-all {
      display: inline-block;
      color: var(--primary-text-color);
      text-decoration: underline;
      text-underline-offset: 4px;
      font-weight: 600;
      font-size: 1.1rem;
      letter-spacing: 0.05em;
      transition: all 0.3s ease;
    }

    .product-showcase__shop-all:hover {
      text-decoration-thickness: 2px;
      opacity: 0.8;
    }

    .product-showcase__slider-container {
      position: relative;
      /* Mobile touch optimization */
      touch-action: pan-y pinch-zoom;
      -webkit-overflow-scrolling: touch;
    }
    
    /* Ensure navigation is positioned relative to slider */
    .product-showcase__slider-container > .product-showcase__navigation {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      pointer-events: none;
      z-index: 10;
    }

    .product-showcase-swiper-{{ section.id }} {
      overflow: visible;
      padding-bottom: 40px; /* Desktop: Normaler Abstand */
    }
    
    /* Nur auf Mobile und Tablet: Blauen Balken näher an Karten ziehen */
    @media screen and (max-width: 1023px) {
      .product-showcase-swiper-{{ section.id }} {
        padding-bottom: 0px !important; /* Blauen Balken direkt an Karten */
      }
    }
    
    /* GPU acceleration nur auf Desktop */
    @media screen and (min-width: 1024px) {
      .product-showcase-swiper-{{ section.id }} {
        transform: translate3d(0, 0, 0);
        -webkit-transform: translate3d(0, 0, 0);
      }
    }

    /* Dynamic height slides - jede Karte passt sich ihrem Inhalt an */
    .product-showcase-swiper-{{ section.id }} .swiper-wrapper {
      align-items: flex-start; /* Karten haben unterschiedliche Höhen */
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }
    
    /* GPU acceleration und will-change nur auf Desktop für bessere Mobile-Performance */
    @media screen and (min-width: 1024px) {
      .product-showcase-swiper-{{ section.id }} .swiper-wrapper {
        transform: translate3d(0, 0, 0);
        -webkit-transform: translate3d(0, 0, 0);
        will-change: transform;
      }
    }

    .product-showcase-swiper-{{ section.id }} .swiper-slide {
      height: auto;
      display: flex;
      width: {{ section.settings.slide_width_mobile | default: 280 }}px;
      /* GPU acceleration for each slide */
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      contain: layout; /* CSS containment für Performance */
    }
    
    
    /* GPU acceleration nur auf Desktop */
    @media screen and (min-width: 1024px) {
      .product-showcase-swiper-{{ section.id }} .swiper-slide {
        transform: translate3d(0, 0, 0);
        -webkit-transform: translate3d(0, 0, 0);
      }
    }

    /* Responsive slide widths */
    @media screen and (min-width: 640px) {
      .product-showcase-swiper-{{ section.id }} .swiper-slide {
        width: {{ section.settings.slide_width_tablet | default: 300 }}px;
      }
    }

    @media screen and (min-width: 1024px) {
      .product-showcase-swiper-{{ section.id }} .swiper-slide {
        width: {{ section.settings.slide_width_desktop | default: 320 }}px;
      }
    }

    @media screen and (min-width: 1280px) {
      .product-showcase-swiper-{{ section.id }} .swiper-slide {
        width: {{ section.settings.slide_width_large | default: 350 }}px;
      }
    }

    .product-showcase__card {
      overflow: hidden;
      width: 100%;
      display: flex;
      flex-direction: column;
      position: relative;
      /* Performance optimization */
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      contain: layout style paint; /* CSS containment für bessere Performance */
    }

    /* Mobile: Minimales Styling für maximale Performance */
    @media screen and (max-width: 1023px) {
      .product-showcase__card {
        border-radius: 8px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
      }
    }

    /* Desktop: Volle visuelle Effekte */
    @media screen and (min-width: 1024px) {
      .product-showcase__card {
        border-radius: {{section.settings.border_radius}}px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        will-change: transform;
      }
      
      .product-showcase__card:hover {
        transform: translateY(-4px);
        box-shadow: 0 12px 32px rgba(0, 0, 0, 0.35);
      }
    }

    .product-showcase__image-container {
      background-color: var(--image-bg-color);
      aspect-ratio: 1;
      position: relative;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      contain: layout paint; /* Performance-Optimierung */
    }

    .product-showcase__image {
      width: 100%;
      height: 100%;
      object-fit: contain;
      object-position: center;
      /* Image performance */
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
    }

    /* Image Hover-Effekt nur auf Desktop */
    @media screen and (min-width: 1024px) {
      .product-showcase__image {
        transition: transform 0.3s ease;
        will-change: transform;
      }
      
      .product-showcase__card:hover .product-showcase__image {
        transform: scale(1.05);
      }
    }

    .product-showcase__placeholder {
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 8px;
    }

    .product-showcase__placeholder-svg {
      width: 60%;
      height: 60%;
      opacity: 0.3;
    }

    .product-showcase__content {
      background: var(--card-content-bg);
      padding: 1.5rem;
      flex: 0 0 auto;
      display: flex;
      flex-direction: column;
      position: relative;
      gap: 10px;
      contain: layout style paint; /* CSS containment für Performance */
    }
    
    /* Content visibility für Off-Screen Performance */
    @media screen and (max-width: 1023px) {
      .product-showcase__content {
        content-visibility: auto;
        contain-intrinsic-size: auto 300px;
      }
    }

    .product-showcase__product-title {
      font-size: 1.3rem;
      font-weight: 700;
      text-align: center;
      background: var(--title-bg-color);
      color: var(--primary-text-color);
      margin: 0 0 0.5rem 0;
      padding: 0 10px;
      letter-spacing: 0.05em;
      line-height: 1.3;
      min-height: 65px;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .product-showcase__description {
      font-size: 1.3rem;
      text-align: center;
      color: var(--secondary-text-color);
      margin: 0 0 0.75rem 0;
      line-height: 1.4;
      /* Einheitliche Höhe und kein Überstehen */
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 3; /* max. 3 Zeilen */
      overflow: hidden;
      max-height: calc(1.4em * 3);
      /* sanfter Fade am Ende (unterstützt in WebKit) */
      -webkit-mask-image: linear-gradient(180deg, #000 80%, rgba(0,0,0,0));
      mask-image: linear-gradient(180deg, #000 80%, rgba(0,0,0,0));
    }

    .product-showcase__price {
      font-size: 1.3rem;
      color: var(--primary-text-color);
      font-weight: 500;
      margin-top: 0.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
    }

    .product-showcase__price-amount {
      font-weight: 700;
      color: var(--primary-text-color);
    }

    /* Enhanced CTA Button Styles */
    .product-showcase__cta {
      border: none;
      border-radius: 8px;
      padding: 0.75rem 1.5rem;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      position: relative;
      z-index: 20; /* Höher als der Link (z-index: 1) */
      min-width: 120px;
      height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      flex-shrink: 0;
      /* Touch optimization */
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
      -webkit-user-select: none;
    }

    .product-showcase__cta--available {
      background: var(--cta-bg-color);
      color: var(--cta-text-color);
    }

    /* Mobile: Kein Shadow für bessere Performance */
    @media screen and (max-width: 1023px) {
      .product-showcase__cta {
        box-shadow: none;
      }
    }

    /* Desktop: Volle visuelle Effekte */
    @media screen and (min-width: 1024px) {
      .product-showcase__cta {
        transition: all 0.3s ease;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
      }
      
      .product-showcase__cta--available:hover:not(:disabled) {
        background: var(--cta-hover-bg);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      }
    }

    .product-showcase__cta--sold-out {
      background: var(--cta-sold-out-bg);
      color: #ffffff;
      cursor: not-allowed;
      opacity: 0.8;
    }

    .product-showcase__cta:active {
      transform: translateY(0);
    }

    .product-showcase__cta:disabled {
      cursor: not-allowed;
      opacity: 0.7;
    }

    .product-showcase__cta-icon {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .product-showcase__cta-icon svg {
      width: 16px;
      height: 16px;
    }

    .product-showcase__cta-text {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .product-showcase__fakt--wrapper {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-top: 3px;
    }

    .product-showcase__fakt--wrapper svg {
      width: 20px;
      height: auto;
      font-weight: 600;
    }
    
    .product-showcase__fakt {
      font-size: 1.5rem;
      color: var(--primary-text-color);
      font-weight: 600;
    }

    .product-showcase__link {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: 1;
      /* Prevent interference with swipe */
      pointer-events: auto;
    }

    /* Error notification */
    .product-showcase__error-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #dc3545;
      color: white;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      z-index: 1000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
      animation: slideInRight 0.3s ease;
    }

    @keyframes slideInRight {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .product-showcase__nav-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      width: 50px;
      height: 50px;
      background: rgba(255, 255, 255, 0.95);
      border: 2px solid var(--primary-text-color);
      color: var(--primary-text-color);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      pointer-events: auto;
      /* Touch optimization */
      touch-action: manipulation;
      -webkit-tap-highlight-color: transparent;
      transition: all 0.3s ease;
    }

    .product-showcase__nav-prev {
      left: -25px;
    }

    .product-showcase__nav-next {
      right: -25px;
    }

    /* Hover-Effekte nur auf Desktop */
    @media screen and (min-width: 1025px) {
      .product-showcase__nav-button:hover {
        background: var(--primary-text-color);
        color: white;
        transform: translateY(-50%) scale(1.1);
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
      }

      .product-showcase__nav-button:active {
        transform: translateY(-50%) scale(0.95);
      }
    }

    .product-showcase__nav-button svg {
      width: 24px;
      height: 24px;
      fill: currentColor;
    }

    /* Responsive adjustments */
    @media screen and (max-width: 1024px) {
      .product-showcase__nav-prev {
        left: 10px;
      }

      .product-showcase__nav-next {
        right: 10px;
      }

      .product-showcase__nav-button {
        width: 44px;
        height: 44px;
        background: rgba(255, 255, 255, 0.98);
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15); /* Leichterer Schatten für Performance */
        transition: none; /* Keine Transitions auf Mobile */
        will-change: auto; /* Kein will-change auf Mobile */
      }
      
      .product-showcase__nav-button:active {
        transform: translateY(-50%) scale(0.92);
      }

      .product-showcase__nav-button svg {
        width: 22px;
        height: 22px;
      }
    }

    @media screen and (max-width: 768px) {
      .product-showcase__header {
        margin-bottom: 2rem;
      }

      .product-showcase__content {
        padding: 0.85rem; /* weniger Weißfläche auf Mobile */
      }

      .product-showcase__cta {
        padding: 0.6rem 1rem;
        font-size: 0.8rem;
        min-width: 100px;
        height: 40px;
      }

      .product-showcase__price {
        flex-direction: row;
        gap: 0.75rem;
        align-items: center;
      }

      .product-showcase__nav-prev {
        left: 5px;
      }

      .product-showcase__nav-next {
        right: 5px;
      }

      .product-showcase__nav-button {
        width: 40px;
        height: 40px;
      }

      .product-showcase__nav-button svg {
        width: 20px;
        height: 20px;
      }
    }

    @media screen and (max-width: 480px) {
      .product-showcase__nav-button {
        width: 36px;
        height: 36px;
        border-width: 1.5px;
      }

      .product-showcase__nav-button svg {
        width: 18px;
        height: 18px;
      }
    }

    .product-showcase-section .section {
      width: 100%;
      padding-left: 2rem;
      margin-right: auto;
      margin-left: auto;
    }

    @media screen and (min-width: 1200px) {
      .product-showcase-section .section {
        padding-left: 5rem;
      }
    }

    @media (min-width: 1360px) {
      .product-showcase-section .section {
        max-width: 1920px;
      }
    }
</style>

{% schema %}
{
  "name": "Produkt Showcase",
  "class": "product-showcase-wrapper",
  "settings": [
    {
      "type": "header",
      "content": "Inhalt"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Überschrift",
      "default": "Das richtige Kit für den Job"
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Überschrift Größe",
      "options": [
        { "value": "h3", "label": "Klein" },
        { "value": "h2", "label": "Mittel" },
        { "value": "h1", "label": "Groß" }
      ],
      "default": "h1"
    },
    {
      "type": "text",
      "id": "shop_all_text",
      "label": "Alle anzeigen Text",
      "default": "ALLE ANZEIGEN"
    },
    {
      "type": "url",
      "id": "shop_all_link",
      "label": "Alle anzeigen Link"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Kollektion"
    },
    {
      "type": "range",
      "id": "products_to_show",
      "label": "Anzuzeigende Produkte",
      "min": 4,
      "max": 20,
      "step": 1,
      "default": 8
    },
    {
      "type": "range",
      "id": "border_radius",
      "label": "Rahmen Radius",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 8
    },
    {
      "type": "header",
      "content": "Farben"
    },
    {
      "type": "color",
      "id": "section_bg_start",
      "label": "Bereich Hintergrund Gradient Start",
      "default": "#FF6B6B"
    },
    {
      "type": "color",
      "id": "section_bg_end",
      "label": "Bereich Hintergrund Gradient Ende",
      "default": "#4ECDC4"
    },
    {
      "type": "color",
      "id": "primary_text_color",
      "label": "Primäre Textfarbe",
      "default": "#2C1810"
    },
    {
      "type": "color",
      "id": "secondary_text_color",
      "label": "Sekundäre Textfarbe (Beschreibungen)",
      "default": "#666666"
    },
    {
      "type": "text",
      "id": "card_content_bg",
      "label": "Karten Inhalt Hintergrund (RGBA)",
      "default": "rgba(255, 255, 255, 0.95)",
      "info": "RGBA Format für Transparenz verwenden, z.B. rgba(255, 255, 255, 0.95)"
    },
    {
      "type": "color",
      "id": "image_bg_color",
      "label": "Bild Hintergrundfarbe",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "titel_bg_color",
      "label": "Titel Hintergrundfarbe",
      "default": "#fdcf46"
    },
    {
      "type": "header",
      "content": "CTA Button Farben"
    },
    {
      "type": "color",
      "id": "cta_bg_color",
      "label": "CTA Button Hintergrund",
      "default": "#2C1810"
    },
    {
      "type": "color",
      "id": "cta_text_color",
      "label": "CTA Button Textfarbe",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "cta_hover_bg",
      "label": "CTA Button Hover Hintergrund",
      "default": "#1a0f0a"
    },
    {
      "type": "color",
      "id": "cta_sold_out_bg",
      "label": "Ausverkauft Button Hintergrund",
      "default": "#dc3545"
    },
    {
      "type": "header",
      "content": "Produktkarten Einstellungen"
    },
    {
      "type": "checkbox",
      "id": "show_product_description",
      "label": "Produktbeschreibung anzeigen",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_price",
      "label": "Preis anzeigen",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_product_link",
      "label": "Karten anklickbar machen",
      "default": true
    },
    {
      "type": "header",
      "content": "Slider Einstellungen"
    },
    {
      "type": "range",
      "id": "slide_width_mobile",
      "label": "Slide Breite (Mobil)",
      "min": 200,
      "max": 400,
      "step": 10,
      "unit": "px",
      "default": 280
    },
    {
      "type": "range",
      "id": "slide_width_tablet",
      "label": "Slide Breite (Tablet)",
      "min": 250,
      "max": 450,
      "step": 10,
      "unit": "px",
      "default": 300
    },
    {
      "type": "range",
      "id": "slide_width_desktop",
      "label": "Slide Breite (Desktop)",
      "min": 280,
      "max": 500,
      "step": 10,
      "unit": "px",
      "default": 320
    },
    {
      "type": "range",
      "id": "slide_width_large",
      "label": "Slide Breite (Große Bildschirme)",
      "min": 300,
      "max": 600,
      "step": 10,
      "unit": "px",
      "default": 350
    },
    {
      "type": "header",
      "content": "Abstände"
    },
    {
      "type": "range",
      "id": "gap_mobile",
      "label": "Abstand zwischen Slides (Mobil)",
      "min": 8,
      "max": 40,
      "step": 2,
      "unit": "px",
      "default": 16
    },
    {
      "type": "range",
      "id": "gap_tablet",
      "label": "Abstand zwischen Slides (Tablet)",
      "min": 8,
      "max": 50,
      "step": 2,
      "unit": "px",
      "default": 20
    },
    {
      "type": "range",
      "id": "gap_desktop",
      "label": "Abstand zwischen Slides (Desktop)",
      "min": 16,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 24
    },
    {
      "type": "range",
      "id": "gap_large",
      "label": "Abstand zwischen Slides (Große Bildschirme)",
      "min": 20,
      "max": 80,
      "step": 2,
      "unit": "px",
      "default": 30
    },
    {
      "type": "header",
      "content": "Navigation"
    },
    {
      "type": "checkbox",
      "id": "show_navigation",
      "label": "Navigationspfeile anzeigen",
      "default": true
    },
    {
      "type": "header",
      "content": "Autoplay"
    },
    {
      "type": "checkbox",
      "id": "autoplay",
      "label": "Slides automatisch rotieren",
      "default": false
    },
    {
      "type": "range",
      "id": "autoplay_delay",
      "label": "Slides wechseln alle",
      "min": 2000,
      "max": 8000,
      "step": 500,
      "unit": "ms",
      "default": 3000,
      "visible_if": "{{ section.settings.autoplay }}"
    },
    {
      "type": "checkbox",
      "id": "loop",
      "label": "Slides in Schleife",
      "default": true
    },
    {
      "type": "range",
      "id": "transition_speed",
      "label": "Übergangsgeschwindigkeit",
      "min": 200,
      "max": 1000,
      "step": 100,
      "unit": "ms",
      "default": 500
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "section_width",
      "label": "Bereich Breite",
      "options": [
        { "value": "page-width", "label": "Seitenbreite" },
        { "value": "full-width", "label": "Vollbreite" }
      ],
      "default": "full-width"
    },
    {
      "type": "header",
      "content": "Bereich Padding"
    },
    {
      "type": "range",
      "id": "padding-block-start",
      "label": "Oberer Abstand",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "padding-block-end",
      "label": "Unterer Abstand",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 60
    },
    {
      "type": "range",
      "id": "margin_top",
      "label": "Oberer Rand",
      "min": 0,
      "max": 120,
      "step": 4,
      "unit": "px",
      "default": 60
    }
  ],
  "presets": [
    {
      "name": "Produkt Showcase",
      "settings": {
        "heading": "Bestseller",
        "shop_all_text": "ALLE ANZEIGEN",
        "products_to_show": 8,
        "show_navigation": true,
        "slide_width_desktop": 320
      }
    }
  ]
}
{% endschema %}


